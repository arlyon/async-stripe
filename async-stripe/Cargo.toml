[package]
name = "async-stripe"
version.workspace = true
edition.workspace = true
rust-version.workspace = true
authors.workspace = true
license.workspace = true
homepage.workspace = true
repository.workspace = true
keywords.workspace = true
categories.workspace = true

[package.metadata.docs.rs]
features = ["runtime-tokio-hyper"]

[lib]
name = "stripe"

[features]
default = ["uuid", "stream"]

stream = []

# runtimes
async = ["futures-util"]
blocking = []

runtime-tokio-hyper = [
    "tokio",
    "hyper-client",
    "hyper-tls",
    "async",
]
runtime-tokio-hyper-rustls = [
    "tokio",
    "hyper-client",
    "hyper-rustls",
    "hyper-rustls-native",
    "async",
]
runtime-tokio-hyper-rustls-webpki = [
    "tokio",
    "hyper-client",
    "hyper-rustls-webpki",
    "async",
]
runtime-blocking = [
    "tokio",
    "tokio/rt",
    "hyper-client",
    "hyper-tls",
    "blocking",
]
runtime-blocking-rustls = [
    "tokio",
    "tokio/rt",
    "hyper-client",
    "hyper-rustls-native",
    "blocking",
]
runtime-blocking-rustls-webpki = [
    "tokio",
    "tokio/rt",
    "hyper-client",
    "hyper-rustls-webpki",
    "blocking",
]
runtime-async-std-surf = [
    "async-std",
    "surf",
    "async",
]

# we need the compat crate if using hyper
hyper-client = ["hyper", "http-types/hyperium_http"]

hyper-rustls-native = ["hyper-rustls", "hyper-rustls/native-tokio"]
hyper-rustls-webpki = ["hyper-rustls", "hyper-rustls/webpki-tokio"]

[dependencies]
stripe_types = {path = "../stripe_types"}
async-std = {version = "1.8,<1.11", optional = true}

thiserror = "1.0.24"
hyper = { version = "0.14", default-features = false, features = ["http1", "http2", "client", "tcp"], optional = true }
hyper-tls = { version = "0.5", optional = true }
hyper-rustls = { version = "0.23", default-features = false, features = ["http1", "http2", "tls12", "logging"], optional = true }
serde_json.workspace = true
serde_qs = "0.10.1"
serde_path_to_error = "0.1.8"
surf = { version = "2.1", optional = true }
tokio = { version = "1.2", optional = true }
uuid = { version = "0.8", optional=true, features=["v4"] }

serde.workspace = true
http-types.workspace = true
smol_str.workspace = true

# stream for lists
futures-util = { version = "0.3.21", optional = true }

# msrv pin
time-core = "<=0.1.0"

[dev-dependencies]
httpmock = "0.6.7"
async-std = { version = "1.10.0", features = ["attributes"] }
tokio = { version = "1.24.1", features = ["rt", "macros"] }
